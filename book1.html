<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
  <title>BabySees - What We See</title>
  <meta name="description" content="Book 1: What We See. Sun, moon, earth, and life.">
  <meta name="theme-color" content="#0a0a0a">
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;800;900&display=swap" rel="stylesheet">
  <style>
    * { margin: 0; padding: 0; box-sizing: border-box; }
    html, body {
      height: 100%;
      overflow: hidden;
      background: #0a0a0a;
      color: white;
      font-family: 'Inter', system-ui, sans-serif;
      -webkit-tap-highlight-color: transparent;
    }

    .app {
      height: 100%;
      display: flex;
      flex-direction: column;
    }

    header {
      padding: 0.5rem 1rem;
      display: flex;
      align-items: center;
      justify-content: space-between;
      background: rgba(0,0,0,0.9);
      border-bottom: 1px solid #1a1a1a;
      z-index: 50;
      flex-shrink: 0;
    }
    .logo { font-size: 0.85rem; font-weight: 800; letter-spacing: 0.05em; color: #666; text-decoration: none; }
    .logo:hover { color: #888; }
    .header-center { display: flex; align-items: center; gap: 0.75rem; }
    .category { font-size: 0.65rem; background: #1a1a1a; padding: 0.25rem 0.5rem; border-radius: 4px; color: #555; text-transform: uppercase; letter-spacing: 0.1em; }
    .progress { font-size: 0.75rem; color: #444; font-variant-numeric: tabular-nums; }

    .mode-toggle { display: flex; gap: 0.25rem; background: #1a1a1a; padding: 0.2rem; border-radius: 6px; }
    .mode-btn { padding: 0.25rem 0.5rem; border: none; background: transparent; color: #555; font-size: 0.65rem; font-weight: 600; cursor: pointer; border-radius: 4px; font-family: inherit; }
    .mode-btn.active { background: #333; color: #fff; }
    .mode-btn:hover:not(.active) { color: #888; }

    .main-container { flex: 1; display: flex; overflow: hidden; }

    .viewer {
      flex: 1;
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: center;
      padding: 1rem;
      position: relative;
      overflow: hidden;
    }

    .page {
      width: min(75vw, 75vh, 500px);
      aspect-ratio: 1;
      position: relative;
      border-radius: 12px;
      overflow: hidden;
      box-shadow: 0 20px 60px rgba(0,0,0,0.5);
      background: #111;
    }
    .app.edit-mode .page { width: min(55vw, 50vh, 380px); }

    .page-image {
      position: absolute;
      inset: 0;
      background-size: cover;
      background-position: center;
      transition: opacity 0.3s;
    }
    .page-image::after {
      content: '';
      position: absolute;
      inset: 0;
      background: linear-gradient(to top, rgba(0,0,0,0.9) 0%, rgba(0,0,0,0.4) 30%, transparent 60%);
    }
    .page-image.loading { opacity: 0; }

    .page-content { position: absolute; bottom: 0; left: 0; right: 0; padding: 1.5rem 1rem 1rem; text-align: center; z-index: 1; }
    .page-word { font-size: clamp(1.8rem, 10vw, 3.5rem); font-weight: 900; text-transform: uppercase; letter-spacing: 0.08em; color: white; }
    .app.edit-mode .page-word { font-size: clamp(1.2rem, 6vw, 2rem); }
    .page-subtitle { font-size: clamp(0.6rem, 2.5vw, 0.85rem); color: rgba(255,255,255,0.6); margin-bottom: 0.3rem; }
    .page-body { font-size: clamp(0.55rem, 2vw, 0.7rem); color: rgba(255,255,255,0.7); line-height: 1.6; max-width: 90%; margin: 0 auto; }

    /* Feedback UI */
    .feedback-section { padding: 1rem; border-bottom: 1px solid #222; }
    .feedback-row { display: flex; align-items: center; justify-content: center; gap: 0.75rem; }
    .thumb-btn { padding: 0.5rem 1rem; border-radius: 8px; border: 2px solid #333; background: #1a1a1a; font-size: 1.25rem; cursor: pointer; transition: all 0.15s; }
    .thumb-btn:hover { transform: scale(1.1); }
    .thumb-btn.up:hover, .thumb-btn.up.active { border-color: #22c55e; background: rgba(34,197,94,0.2); }
    .thumb-btn.down:hover, .thumb-btn.down.active { border-color: #ef4444; background: rgba(239,68,68,0.2); }
    .feedback-status { font-size: 0.75rem; color: #666; min-width: 60px; text-align: center; }

    .comment-row { margin-top: 0.75rem; }
    .comment-input { width: 100%; padding: 0.5rem; border-radius: 6px; border: 1px solid #333; background: #1a1a1a; color: white; font-size: 0.8rem; font-family: inherit; }
    .comment-input::placeholder { color: #555; }

    /* Side Panel */
    .side-panel { display: none; width: 280px; background: #111; border-left: 1px solid #222; flex-direction: column; }
    .app.edit-mode .side-panel { display: flex; }
    .panel-header { padding: 0.75rem 1rem; border-bottom: 1px solid #222; font-size: 0.8rem; font-weight: 600; color: #888; }
    .panel-content { flex: 1; overflow-y: auto; padding: 0.5rem; }
    .export-area { width: 100%; height: 100%; min-height: 200px; padding: 0.5rem; border: 1px solid #222; border-radius: 6px; background: #0a0a0a; color: #aaa; font-family: monospace; font-size: 0.7rem; resize: none; }
    .copy-btn { margin: 0.5rem; padding: 0.5rem; border-radius: 4px; border: none; background: #333; color: #aaa; font-size: 0.75rem; cursor: pointer; font-family: inherit; }
    .copy-btn:hover { background: #444; color: white; }

    .nav-zones { position: absolute; inset: 0; display: flex; z-index: 20; }
    .nav-zone { flex: 1; cursor: pointer; }
    .nav-zone:active { background: rgba(255,255,255,0.02); }

    footer { padding: 0.5rem; display: flex; justify-content: center; gap: 0.3rem; flex-wrap: wrap; background: rgba(0,0,0,0.9); }
    .dot { width: 8px; height: 8px; border-radius: 50%; background: #333; cursor: pointer; transition: all 0.2s; }
    .dot:hover { background: #555; }
    .dot.active { background: #888; transform: scale(1.3); }
    .dot.up { background: #22c55e; }
    .dot.down { background: #ef4444; }

    .loader { position: absolute; inset: 0; display: flex; align-items: center; justify-content: center; background: #0a0a0a; z-index: 10; opacity: 1; transition: opacity 0.3s; }
    .loader.hidden { opacity: 0; pointer-events: none; }
    .spinner { width: 40px; height: 40px; border: 3px solid #222; border-top-color: #666; border-radius: 50%; animation: spin 0.8s linear infinite; }
    @keyframes spin { to { transform: rotate(360deg); } }
  </style>
</head>
<body>
  <div class="app" id="app">
    <header>
      <a href="index.html" class="logo">BABYSEES</a>
      <div class="header-center">
        <span class="category" id="category">Nature</span>
        <span class="progress"><span id="current">1</span>/<span id="total">20</span></span>
      </div>
      <div class="mode-toggle">
        <button class="mode-btn active" id="readMode">Read</button>
        <button class="mode-btn" id="editMode">Edit</button>
      </div>
    </header>

    <div class="main-container">
      <div class="viewer" id="viewer">
        <div class="loader" id="loader"><div class="spinner"></div></div>
        <div class="page" id="page">
          <div class="page-image" id="pageImage"></div>
          <div class="page-content" id="pageContent"></div>
        </div>
        <div class="nav-zones">
          <div class="nav-zone" id="navPrev"></div>
          <div class="nav-zone" id="navNext"></div>
        </div>

      </div>

      <div class="side-panel">
        <div class="panel-header">Review</div>
        <div class="feedback-section">
          <div class="feedback-row">
            <button class="thumb-btn up" id="thumbUp">üëç</button>
            <span class="feedback-status" id="feedbackStatus">‚Äî</span>
            <button class="thumb-btn down" id="thumbDown">üëé</button>
          </div>
          <div class="comment-row">
            <input type="text" class="comment-input" id="commentInput" placeholder="Add comment...">
          </div>
        </div>
        <div class="panel-header">Export Feedback</div>
        <div class="panel-content">
          <textarea class="export-area" id="exportArea" readonly></textarea>
        </div>
        <button class="copy-btn" id="copyBtn">Copy to Clipboard</button>
      </div>
    </div>

    <footer id="dots"></footer>
  </div>

  <script>
    const bookId = 'book1';
    const bookTitle = "What We See";
    const bookIntro = "The World Around Us";
    const bookDesc = "From the blazing sun to the glowing moon, from the depths of the ocean to the dance of the aurora. These are the wonders we see with our eyes every day.";

    // Pages: Light & Color Arc (Bright -> Cool -> Warm)
    const pages = [
      { word: "BabySees", image: "https://upload.wikimedia.org/wikipedia/commons/thumb/6/68/Pillars_of_creation_2014_HST_WFC3-UVIS_full-res_denoised.jpg/800px-Pillars_of_creation_2014_HST_WFC3-UVIS_full-res_denoised.jpg", category: "Title", isTitle: true },
      { word: "Introduction", image: "https://images.unsplash.com/photo-1506748686214-e9df14d4d9d0?w=800", category: "Intro", isIntro: true },
      // BRIGHT
      { word: "Sun", image: "https://upload.wikimedia.org/wikipedia/commons/thumb/b/b4/The_Sun_by_the_Atmospheric_Imaging_Assembly_of_NASA%27s_Solar_Dynamics_Observatory_-_20100819.jpg/800px-The_Sun_by_the_Atmospheric_Imaging_Assembly_of_NASA%27s_Solar_Dynamics_Observatory_-_20100819.jpg", category: "Bright" },
      { word: "Lightning", image: "https://upload.wikimedia.org/wikipedia/commons/thumb/8/85/Summer_lightning_storm_over_the_City_of_Kamloops%2C_BC_%2819414087284%29.jpg/960px-Summer_lightning_storm_over_the_City_of_Kamloops%2C_BC_%2819414087284%29.jpg", category: "Bright" },
      { word: "Rainbow", image: "https://upload.wikimedia.org/wikipedia/commons/thumb/5/5c/Double-alaskan-rainbow.jpg/800px-Double-alaskan-rainbow.jpg", category: "Bright" },
      { word: "Aurora", image: "https://upload.wikimedia.org/wikipedia/commons/thumb/a/aa/Polarlicht_2.jpg/800px-Polarlicht_2.jpg", category: "Bright" },
      // COOL
      { word: "Stars", image: "https://upload.wikimedia.org/wikipedia/commons/thumb/4/43/ESO-VLT-Laser-phot-33a-07.jpg/800px-ESO-VLT-Laser-phot-33a-07.jpg", category: "Cool" },
      { word: "Moon", image: "https://upload.wikimedia.org/wikipedia/commons/thumb/e/e1/FullMoon2010.jpg/800px-FullMoon2010.jpg", category: "Cool" },
      { word: "Earth", image: "https://upload.wikimedia.org/wikipedia/commons/thumb/c/cb/The_Blue_Marble_%28remastered%29.jpg/800px-The_Blue_Marble_%28remastered%29.jpg", category: "Cool" },
      { word: "Ocean", image: "https://upload.wikimedia.org/wikipedia/commons/thumb/e/e0/Clouds_over_the_Atlantic_Ocean.jpg/800px-Clouds_over_the_Atlantic_Ocean.jpg", category: "Cool" },
      { word: "Glacier", image: "https://upload.wikimedia.org/wikipedia/commons/thumb/7/7c/Perito_Moreno_Glacier_Patagonia_Argentina_Luca_Galuzzi_2005.JPG/800px-Perito_Moreno_Glacier_Patagonia_Argentina_Luca_Galuzzi_2005.JPG", category: "Cool" },
      { word: "Jellyfish", image: "https://upload.wikimedia.org/wikipedia/commons/thumb/4/44/Jelly_cc11.jpg/800px-Jelly_cc11.jpg", category: "Cool" },
      { word: "Crystal", image: "https://upload.wikimedia.org/wikipedia/commons/thumb/1/14/Quartz%2C_Tibet.jpg/800px-Quartz%2C_Tibet.jpg", category: "Cool" },
      { word: "Peacock", image: "https://upload.wikimedia.org/wikipedia/commons/thumb/c/c5/Peacock_Plumage.jpg/800px-Peacock_Plumage.jpg", category: "Cool" },
      { word: "Butterfly", image: "https://upload.wikimedia.org/wikipedia/commons/thumb/e/e8/Morpho_menelaus_huebneri_MHNT_Male_dos.jpg/800px-Morpho_menelaus_huebneri_MHNT_Male_dos.jpg", category: "Cool" },
      { word: "Camouflage", image: "https://upload.wikimedia.org/wikipedia/commons/thumb/b/b0/Camouflage_DSC05765.JPG/800px-Camouflage_DSC05765.JPG", category: "Cool" },
      // WARM
      { word: "Coral", image: "https://upload.wikimedia.org/wikipedia/commons/thumb/a/a4/Coral_reef_at_palmyra.jpg/800px-Coral_reef_at_palmyra.jpg", category: "Warm" },
      { word: "Lava", image: "https://upload.wikimedia.org/wikipedia/commons/thumb/4/48/Pahoehoe_toe.jpg/800px-Pahoehoe_toe.jpg", category: "Warm" },
      { word: "Eclipse", image: "https://upload.wikimedia.org/wikipedia/commons/thumb/1/1c/Solar_eclipse_1999_4_NR.jpg/800px-Solar_eclipse_1999_4_NR.jpg", category: "Warm" },
      { word: "Credits", image: "https://upload.wikimedia.org/wikipedia/commons/thumb/6/68/Pillars_of_creation_2014_HST_WFC3-UVIS_full-res_denoised.jpg/800px-Pillars_of_creation_2014_HST_WFC3-UVIS_full-res_denoised.jpg", category: "Credits", isCredits: true },
    ];

    const feedback = {};
    let currentPage = 0;
    let editMode = false;

    const app = document.getElementById('app');
    const imageEl = document.getElementById('pageImage');
    const contentEl = document.getElementById('pageContent');
    const loader = document.getElementById('loader');
    const dotsContainer = document.getElementById('dots');
    const commentInput = document.getElementById('commentInput');
    const exportArea = document.getElementById('exportArea');

    document.getElementById('total').textContent = pages.length;

    document.getElementById('readMode').onclick = () => setMode(false);
    document.getElementById('editMode').onclick = () => setMode(true);

    function setMode(isEdit) {
      editMode = isEdit;
      app.classList.toggle('edit-mode', isEdit);
      document.getElementById('readMode').classList.toggle('active', !isEdit);
      document.getElementById('editMode').classList.toggle('active', isEdit);
      if (isEdit) { loadFeedback(); updateExport(); }
    }

    pages.forEach((p, i) => {
      const dot = document.createElement('div');
      dot.className = 'dot';
      dot.onclick = () => goToPage(i);
      dotsContainer.appendChild(dot);
    });

    function getFeedbackKey(idx) { return `babysees_${bookId}_page${idx}`; }

    function getFeedback(idx) {
      const data = localStorage.getItem(getFeedbackKey(idx));
      return data ? JSON.parse(data) : { rating: null, comment: '' };
    }

    function saveFeedback(idx, rating, comment) {
      localStorage.setItem(getFeedbackKey(idx), JSON.stringify({ rating, comment, timestamp: Date.now() }));
      updateDots();
      updateExport();
    }

    function loadFeedback() {
      const fb = getFeedback(currentPage);
      commentInput.value = fb.comment || '';
      document.getElementById('thumbUp').classList.toggle('active', fb.rating === 'up');
      document.getElementById('thumbDown').classList.toggle('active', fb.rating === 'down');
      updateStatus(fb.rating);
    }

    function updateStatus(rating) {
      const el = document.getElementById('feedbackStatus');
      if (rating === 'up') { el.textContent = '‚úì Keep'; el.style.color = '#22c55e'; }
      else if (rating === 'down') { el.textContent = '‚úó Replace'; el.style.color = '#ef4444'; }
      else { el.textContent = '‚Äî'; el.style.color = '#666'; }
    }

    function updateDots() {
      document.querySelectorAll('.dot').forEach((d, i) => {
        const fb = getFeedback(i);
        d.className = 'dot';
        if (i === currentPage) d.classList.add('active');
        if (fb.rating === 'up') d.classList.add('up');
        else if (fb.rating === 'down') d.classList.add('down');
      });
    }

    function updateExport() {
      let text = `# ${bookTitle} Feedback\n\n`;
      let ups = 0, downs = 0;
      pages.forEach((p, i) => {
        if (p.isTitle || p.isIntro || p.isCredits) return;
        const fb = getFeedback(i);
        if (fb.rating === 'up') ups++;
        else if (fb.rating === 'down') downs++;
        if (fb.rating || fb.comment) {
          const icon = fb.rating === 'up' ? 'üëç' : fb.rating === 'down' ? 'üëé' : '‚Äî';
          text += `${icon} **${p.word}**`;
          if (fb.comment) text += `: ${fb.comment}`;
          text += `\n`;
        }
      });
      text += `\n---\nTotal: ${ups} keep, ${downs} replace\n`;
      exportArea.value = text;
    }

    document.getElementById('thumbUp').onclick = () => {
      const fb = getFeedback(currentPage);
      const newRating = fb.rating === 'up' ? null : 'up';
      saveFeedback(currentPage, newRating, fb.comment);
      loadFeedback();
    };

    document.getElementById('thumbDown').onclick = () => {
      const fb = getFeedback(currentPage);
      const newRating = fb.rating === 'down' ? null : 'down';
      saveFeedback(currentPage, newRating, fb.comment);
      loadFeedback();
    };

    commentInput.oninput = () => {
      const fb = getFeedback(currentPage);
      saveFeedback(currentPage, fb.rating, commentInput.value);
    };

    document.getElementById('copyBtn').onclick = () => {
      exportArea.select();
      document.execCommand('copy');
      document.getElementById('copyBtn').textContent = 'Copied!';
      setTimeout(() => document.getElementById('copyBtn').textContent = 'Copy to Clipboard', 1500);
    };

    function updatePage() {
      const p = pages[currentPage];
      loader.classList.remove('hidden');
      const img = new Image();
      img.onload = () => {
        imageEl.style.backgroundImage = `url(${p.image})`;
        loader.classList.add('hidden');
      };
      img.onerror = () => { loader.classList.add('hidden'); };
      img.src = p.image;

      if (p.isTitle) {
        contentEl.innerHTML = `<div class="page-subtitle">${bookTitle}</div><div class="page-word">BabySees</div>`;
      } else if (p.isIntro) {
        contentEl.innerHTML = `<div class="page-word" style="font-size:clamp(1.2rem,6vw,2rem);margin-bottom:0.5rem">${bookIntro}</div><div class="page-body">${bookDesc}</div>`;
      } else if (p.isCredits) {
        contentEl.innerHTML = `<div class="page-word" style="font-size:clamp(1rem,4vw,1.5rem)">Credits</div><div class="page-body">Images: NASA, ESA, Wikimedia Commons</div>`;
      } else {
        contentEl.innerHTML = `<div class="page-word">${p.word}</div>`;
      }

      document.getElementById('current').textContent = currentPage + 1;
      document.getElementById('category').textContent = p.category;
      updateDots();
      if (editMode) loadFeedback();
    }

    function goToPage(idx) {
      if (idx < 0 || idx >= pages.length) return;
      currentPage = idx;
      updatePage();
    }

    document.getElementById('navPrev').onclick = () => goToPage(currentPage - 1);
    document.getElementById('navNext').onclick = () => goToPage(currentPage + 1);

    document.addEventListener('keydown', (e) => {
      if (e.target.tagName === 'INPUT') return;
      if (e.key === 'ArrowLeft') goToPage(currentPage - 1);
      else if (e.key === 'ArrowRight') goToPage(currentPage + 1);
    });

    let touchStartX = 0;
    document.getElementById('viewer').addEventListener('touchstart', (e) => { touchStartX = e.changedTouches[0].screenX; }, { passive: true });
    document.getElementById('viewer').addEventListener('touchend', (e) => {
      const diff = touchStartX - e.changedTouches[0].screenX;
      if (Math.abs(diff) > 50) diff > 0 ? goToPage(currentPage + 1) : goToPage(currentPage - 1);
    }, { passive: true });

    updatePage();
  </script>
</body>
</html>
